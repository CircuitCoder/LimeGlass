<div class="view">
  <div class="seal"></div>
  <div class="questions">
    <div class="questions-list">
      <div class="filter">
        <input class="expand" v-model="filter" placeholder="过滤">
        <i class="material-icons"
          @click="filterAssigned = !filterAssigned"
          :style="{ opacity: filterAssigned ? .7 : .38 }">assignment_late</i>
        <i class="material-icons"
          @click="filterInfo = !filterInfo"
          :style="{ opacity: filterInfo ? .7 : .38 }">edit</i>
      </div>
      <div class="question-person" v-for="l of filtered" @click="select(l)" :class="{ selected: selected === l }" :key="l._id">
        <div class="question-person-name">{{ l.name }}</div>
        <div class="question-person-count">TODO</div>
      </div>
    </div>
    <div class="questions-content" v-if="selected">
      <div class="title">管理面试 <small>{{ selected.name }}</small></div>
      <button @click="$router.push({ name: 'info', query: { admin: true, _id: selected._id, name: selected.name } })">查看个人信息</button>
      <button @click="setReviewerRole(selected._id, !selected.isReviewer)">{{ selected.isReviewer ? '身份设为代表' : '身份设为面试官' }}</button>
      <div v-if="!selected.isReviewer">
        <p>
          <div class="hint">共 {{ selected.rounds ? selected.rounds.length : 0 }} 轮</div>
        </p>
        <button @click="showAddReview()">添加面试</button>
        <div v-for="(r, i) of selected.rounds">
          <div class="subtitle narrow-margin"># 第 {{ i + 1 }} 轮</div>
          <div>面试官: <strong>{{ names(r.reviewers) }}</strong></div>
          <div class="review-status">状态: <strong><i class="material-icons">{{ STATUS_ICON[r.result] }}</i>{{ STATUS_MAP[r.result] }}</strong></div>
          <div class="input-hint">面试官笔记</div>
          <textarea v-model="r.notes"></textarea>
          <div class="input-hint">题目</div>
          <textarea v-model="r.questions" placeholder="每行一个"></textarea>
          <div class="input-hint">回答</div>
          <textarea v-model="r.answers" placeholder="每行一个"></textarea>
        </div>
      </div>
      <transition name="fade">
        <div class="view backdrop centering" key="reviewer" v-if="addReview" @click="addReview = false">
          <div class="backdrop-wrapper">
            <div class="form larger" @click.stop>
              <div class="block opaque">
                <div class="seal"></div>
                <div class="form-heading">请从以下面试官中选择</div>
                <div class="hint">您可以从这一页面设置用户的身份</div>
                <div class="hint" v-if="selectedReviewers.length === 0">请选择至少一个面试官</div>
                <div class="hint" v-if="selectedReviewers.length > 0">已选择: {{ reviewerNames }}</div>
                <button @click="addRound" class="primary" :disabled="selectedReviewers.length === 0">提交</button>
                <hr>
                <div v-for="p of reviewers">
                  <button @click="toggleReviewer(p)" class="selector" :class="{ primary: reviewerSet[p._id], selected: reviewerSet[p._id] }">{{ p.name }}</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </transition>
    </div>
  </div>
</div>
